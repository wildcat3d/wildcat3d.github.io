<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WildCAT Video Results</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f8f9fa;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem 0;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            font-weight: 300;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        .nav-tabs {
            display: flex;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
            overflow: hidden;
        }

        .nav-tab {
            flex: 1;
            padding: 1.2rem 1.5rem;
            background: white;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s ease;
            position: relative;
        }

        .nav-tab:hover {
            background: #f8f9fa;
        }

        .nav-tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .nav-tab.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: rgba(255,255,255,0.3);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .section-title {
            font-size: 2rem;
            color: #2c3e50;
            margin-bottom: 1.5rem;
            text-align: center;
            font-weight: 300;
        }

        .section-description {
            background: white;
            padding: 1.5rem;
            border-radius: 10px;
            margin-bottom: 2rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            border-left: 4px solid #667eea;
        }

        .results-grid {
            display: grid;
            gap: 2rem;
        }

        .result-item {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .result-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px rgba(0,0,0,0.15);
        }

        .result-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #eee;
        }

        .media-container {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .media-item {
            text-align: center;
            flex: 1;
            min-width: 200px;
        }

        .media-label {
            font-weight: 500;
            color: #666;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .media-content {
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
            cursor: pointer;
        }

        .media-content:hover {
            transform: scale(1.02);
        }

        .media-content img, .media-content video {
            width: 100%;
            height: auto;
            display: block;
        }

        .lazy-load {
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .lazy-load.loaded {
            opacity: 1;
        }

        .loading-placeholder {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
            border-radius: 10px;
            height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
        }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        .inference-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
        }

        .fullscreen-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .fullscreen-content {
            max-width: 90%;
            max-height: 90%;
            position: relative;
        }

        .fullscreen-close {
            position: absolute;
            top: -40px;
            right: 0;
            background: none;
            border: none;
            color: white;
            font-size: 2rem;
            cursor: pointer;
            padding: 0.5rem;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: white;
            padding: 1.5rem;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: #667eea;
        }

        .stat-label {
            color: #666;
            margin-top: 0.5rem;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>WildCAT Video Results</h1>
    </div>

    <div class="container">
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('inference')">
                Inference Results
            </button>
            <button class="nav-tab" onclick="showTab('appearance')">
                Appearance-Controlled Generation
            </button>
            <button class="nav-tab" onclick="showTab('interpolation')">
                Interpolation
            </button>
        </div>

        <!-- Inference Results Tab -->
        <div id="inference" class="tab-content active">
            <h2 class="section-title">Novel View Synthesis Inference</h2>
            <div class="section-description">
                <p>Results showing vanilla WildCAT inference for novel view synthesis with various hard-coded trajectories including lateral turns, zoom-outs, and NeRF-like circular paths. Each result shows the input view and video showing generated novel views.</p>
            </div>
            
            <div class="stats" id="inference-stats">
                <div class="stat-card">
                    <div class="stat-number" id="inference-count">0</div>
                    <div class="stat-label">Scene Results</div>
                </div>
            </div>

            <div class="results-grid inference-grid" id="inference-results">
                <!-- Inference results will be loaded here -->
            </div>
        </div>

        <!-- Appearance-Controlled Generation Tab -->
        <div id="appearance" class="tab-content">
            <h2 class="section-title">Appearance-Controlled Generation</h2>
            <div class="section-description">
                <p>Results demonstrating appearance control during generation. By injecting appearance embeddings from external images, WildCAT can generate novel views while editing scene appearance (e.g., generating nighttime scenes from daytime photos). Each result shows the appearance conditioning image, generated view, and input view for comparison.</p>
            </div>

            <div class="stats" id="appearance-stats">
                <div class="stat-card">
                    <div class="stat-number" id="appearance-count">0</div>
                    <div class="stat-label">Generation Results</div>
                </div>
            </div>

            <div class="results-grid" id="appearance-results">
                <!-- Appearance results will be loaded here -->
            </div>
        </div>

        <!-- Interpolation Tab -->
        <div id="interpolation" class="tab-content">
            <h2 class="section-title">In-the-Wild Interpolation</h2>
            <div class="section-description">
                <p>Results showing interpolation between views of scenes with differing appearances. WildCAT fine-tuned with two observed input views can interpolate between them to produce static videos with consistent appearance. Two interpolations are provided for each scene: one using the start view's appearance and another using the end view's appearance throughout the trajectory.</p>
            </div>

            <div class="stats" id="interpolation-stats">
                <div class="stat-card">
                    <div class="stat-number" id="interpolation-count">0</div>
                    <div class="stat-label">Interpolation Sequences</div>
                </div>
            </div>

            <div class="results-grid" id="interpolation-results">
                <!-- Interpolation results will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Fullscreen overlay -->
    <div class="fullscreen-overlay" id="fullscreen-overlay" onclick="closeFullscreen()">
        <div class="fullscreen-content" onclick="event.stopPropagation()">
            <button class="fullscreen-close" onclick="closeFullscreen()">&times;</button>
            <div id="fullscreen-media"></div>
        </div>
    </div>

    <script>
        // Global state
        let currentTab = 'inference';
        let loadedTabs = new Set(['inference']); // Start with inference loaded
        
        // File structure based on actual directory structure
        const fileStructure = {
            inference: {
                'images-000-027-commons-Arco_dei_Gavi_(Verona)-0-pictures': ['0', '1', '3'],
                'images-000-033-commons-Porte_de_Paris_(Lille)-0-pictures': ['0', '1', '2'],
                'images-000-034-commons-Events_at_Monumento_a_la_Revolución_(México)-0-pictures': ['0'],
                'images-000-034-commons-Monumento_a_la_Revolución_(México)_(cara_oriente)-0-pictures': ['0', '1'],
                'images-000-034-commons-Tapete_floral_en_el_Monumento_a_la_Revolución-0-pictures': ['0'],
                'images-000-123-commons-Monumental_Arch_of_Palmyra-0-pictures': ['0', '1'],
                'images-014-126-commons-Pont_de_la_Caille-0-pictures': ['0'],
                'images-014-161-commons-South_Stack_Lighthouse-0-pictures': ['0'],
                'images-017-511-commons-Barnard_Castle_Bridge-0-pictures': ['0'],
                'images-024-960-commons-Organ_of_the_Pécs_Cathedral-0-pictures': ['0'],
                'images-024-978-commons-Duomo_(Modena)_-_Interior-0-pictures': ['0'],
                'images-025-096-commons-North_portal_of_San_Nicola_(Bari)-0-pictures': ['0'],
                'images-025-118-commons-Wawel_Cathedral_-_southern_facade-0-pictures': ['0'],
                'images-025-118-commons-Wawel_Cathedral_-_western_facade-0-pictures': ['0', '1']
            },
            appearance: [0, 1, 2, 3, 4, 5],
            interpolation: [1, 2, 3, 4, 5]
        };

        function showTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked tab
            event.target.classList.add('active');
            
            currentTab = tabName;
            
            // Load content if not already loaded
            if (!loadedTabs.has(tabName)) {
                loadTabContent(tabName);
                loadedTabs.add(tabName);
            }
        }

        function loadTabContent(tabName) {
            switch(tabName) {
                case 'inference':
                    loadInferenceResults();
                    break;
                case 'appearance':
                    loadAppearanceResults();
                    break;
                case 'interpolation':
                    loadInterpolationResults();
                    break;
            }
        }

        function loadInferenceResults() {
            const container = document.getElementById('inference-results');
            const countElement = document.getElementById('inference-count');
            
            const scenes = Object.keys(fileStructure.inference);
            countElement.textContent = scenes.length;
            
            scenes.forEach((sceneName) => {
                const viewIndices = fileStructure.inference[sceneName];
                const resultItem = document.createElement('div');
                resultItem.className = 'result-item';
                
                // Clean up scene name for display
                const displayName = sceneName
                    .replace(/images-\d+-\d+-commons-/, '')
                    .replace(/-\d+-pictures$/, '')
                    .replace(/[_()]/g, ' ')
                    .replace(/Ã\u0081/g, 'á')
                    .replace(/Ã\u0089/g, 'é');
                
                let mediaHtml = '';
                viewIndices.forEach(index => {
                    mediaHtml += `
                        <div class="media-item">
                            <div class="media-label">Input View ${index}</div>
                            <div class="media-content" onclick="openFullscreen('inference/${sceneName}/gt${index}.png', 'image')">
                                <div class="loading-placeholder">Loading...</div>
                                <img class="lazy-load" data-src="inference/${sceneName}/gt${index}.png" alt="Input View ${index}">
                            </div>
                        </div>
                        <div class="media-item">
                            <div class="media-label">Generated ${index}</div>
                            <div class="media-content" onclick="openFullscreen('inference/${sceneName}/gen${index}.gif', 'gif')">
                                <div class="loading-placeholder">Loading...</div>
                                <img class="lazy-load" data-src="inference/${sceneName}/gen${index}.gif" alt="Generated ${index}">
                            </div>
                        </div>
                    `;
                });
                
                resultItem.innerHTML = `
                    <div class="result-title">Scene: ${displayName}</div>
                    <div class="media-container">
                        ${mediaHtml}
                    </div>
                `;
                
                container.appendChild(resultItem);
            });
            
            // Lazy load images when they come into view
            observeImages();
        }

        function loadAppearanceResults() {
            const container = document.getElementById('appearance-results');
            const countElement = document.getElementById('appearance-count');
            
            const indices = fileStructure.appearance;
            countElement.textContent = indices.length;
            
            indices.forEach(i => {
                const resultItem = document.createElement('div');
                resultItem.className = 'result-item';
                
                resultItem.innerHTML = `
                    <div class="result-title">Appearance-Controlled Generation ${i}</div>
                    <div class="media-container">
                        <div class="media-item">
                            <div class="media-label">Input View</div>
                            <div class="media-content" onclick="openFullscreen('applications/appearance_conditioned_gen/${i}_gt.png', 'image')">
                                <div class="loading-placeholder">Loading...</div>
                                <img class="lazy-load" data-src="applications/appearance_conditioned_gen/${i}_gt.png" alt="Input View ${i}">
                            </div>
                        </div>
                        <div class="media-item">
                            <div class="media-label">Appearance Condition</div>
                            <div class="media-content" onclick="openFullscreen('applications/appearance_conditioned_gen/${i}_appearance.png', 'image')">
                                <div class="loading-placeholder">Loading...</div>
                                <img class="lazy-load" data-src="applications/appearance_conditioned_gen/${i}_appearance.png" alt="Appearance ${i}">
                            </div>
                        </div>
                        <div class="media-item">
                            <div class="media-label">Generated Result</div>
                            <div class="media-content" onclick="openFullscreen('applications/appearance_conditioned_gen/${i}_gen.gif', 'gif')">
                                <div class="loading-placeholder">Loading...</div>
                                <img class="lazy-load" data-src="applications/appearance_conditioned_gen/${i}_gen.gif" alt="Generated ${i}">
                            </div>
                        </div>
                    </div>
                `;
                
                container.appendChild(resultItem);
            });
            
            observeImages();
        }

        function loadInterpolationResults() {
            const container = document.getElementById('interpolation-results');
            const countElement = document.getElementById('interpolation-count');
            
            const sequences = fileStructure.interpolation;
            countElement.textContent = sequences.length;
            
            sequences.forEach(seqNum => {
                const resultItem = document.createElement('div');
                resultItem.className = 'result-item';
                
                resultItem.innerHTML = `
                    <div class="result-title">Interpolation Sequence ${seqNum}</div>
                    <div class="media-container">
                        <div class="media-item">
                            <div class="media-label">Start View</div>
                            <div class="media-content" onclick="openFullscreen('applications/interpolation/${seqNum}_start.png', 'image')">
                                <div class="loading-placeholder">Loading...</div>
                                <img class="lazy-load" data-src="applications/interpolation/${seqNum}_start.png" alt="Start ${seqNum}">
                            </div>
                        </div>
                        <div class="media-item">
                            <div class="media-label">Interpolation (Start Appearance)</div>
                            <div class="media-content" onclick="openFullscreen('applications/interpolation/${seqNum}_interp.gif', 'gif')">
                                <div class="loading-placeholder">Loading...</div>
                                <img class="lazy-load" data-src="applications/interpolation/${seqNum}_interp.gif" alt="Interpolation ${seqNum}">
                            </div>
                        </div>
                        <div class="media-item">
                            <div class="media-label">Interpolation (End Appearance)</div>
                            <div class="media-content" onclick="openFullscreen('applications/interpolation/${seqNum}_interp_.gif', 'gif')">
                                <div class="loading-placeholder">Loading...</div>
                                <img class="lazy-load" data-src="applications/interpolation/${seqNum}_interp_.gif" alt="Interpolation End ${seqNum}">
                            </div>
                        </div>
                        <div class="media-item">
                            <div class="media-label">End View</div>
                            <div class="media-content" onclick="openFullscreen('applications/interpolation/${seqNum}_end.png', 'image')">
                                <div class="loading-placeholder">Loading...</div>
                                <img class="lazy-load" data-src="applications/interpolation/${seqNum}_end.png" alt="End ${seqNum}">
                            </div>
                        </div>
                    </div>
                `;
                
                container.appendChild(resultItem);
            });
            
            observeImages();
        }

        function observeImages() {
            const imageObserver = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const img = entry.target;
                        const placeholder = img.previousElementSibling;
                        
                        img.src = img.dataset.src;
                        img.onload = () => {
                            img.classList.add('loaded');
                            if (placeholder) {
                                placeholder.style.display = 'none';
                            }
                        };
                        
                        observer.unobserve(img);
                    }
                });
            });

            document.querySelectorAll('.lazy-load').forEach(img => {
                imageObserver.observe(img);
            });
        }

        function openFullscreen(src, type) {
            const overlay = document.getElementById('fullscreen-overlay');
            const mediaContainer = document.getElementById('fullscreen-media');
            
            let mediaElement;
            if (type === 'gif' || type === 'image') {
                mediaElement = document.createElement('img');
                mediaElement.src = src;
                mediaElement.style.maxWidth = '100%';
                mediaElement.style.maxHeight = '100%';
            }
            
            mediaContainer.innerHTML = '';
            mediaContainer.appendChild(mediaElement);
            overlay.style.display = 'flex';
        }

        function closeFullscreen() {
            document.getElementById('fullscreen-overlay').style.display = 'none';
        }

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            loadInferenceResults();
        });

        // Handle escape key for fullscreen
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeFullscreen();
            }
        });
    </script>
</body>
</html>